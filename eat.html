<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>åˆé¤å»ºè­°æ©Ÿå™¨äºº</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: #e5ddd5;
      margin: 0;
      padding: 20px;
    }

    .chat {
      max-width: 420px;
      margin: auto;
      background: #f7f7f7;
      border-radius: 12px;
      padding: 10px;
      height: 450px;
      overflow-y: auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }

    .bubble {
      max-width: 75%;
      padding: 8px 12px;
      margin: 6px 0;
      border-radius: 16px;
      font-size: 14px;
      line-height: 1.4;
      clear: both;
      position: relative;
    }

    .bot {
      background: #ffffff;
      float: left;
      border-bottom-left-radius: 4px;
    }

    .user {
      background: #9eea6a;
      float: right;
      border-bottom-right-radius: 4px;
    }

    .buttons {
      max-width: 420px;
      margin: 10px auto 0;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    button {
      flex: 1;
      padding: 8px 0;
      font-size: 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .food-btn {
      background: #ffffff;
    }

    .reset-btn {
      background: #ffb3b3;
      width: 100%;
    }
  </style>
</head>

<body>

<div class="chat" id="chat"></div>

<div class="buttons">
  <button class="food-btn" onclick="choose('ä¾¿ç•¶')">ä¾¿ç•¶</button>
  <button class="food-btn" onclick="choose('éºµ')">éºµ</button>
  <button class="food-btn" onclick="choose('é£¯')">é£¯</button>
  <button class="food-btn" onclick="choose('é€Ÿé£Ÿ')">é€Ÿé£Ÿ</button>
  <button class="food-btn" onclick="choose('éš¨æ©Ÿ')">éš¨æ©Ÿ</button>
  <button class="reset-btn" onclick="resetToday()">é‡æ–°é–‹å§‹ä»Šå¤©</button>
</div>

<script>
  const LUNCH_OPTIONS = {
    ä¾¿ç•¶: ["é›è…¿ä¾¿ç•¶", "æ’éª¨ä¾¿ç•¶", "æ»·è‚‰ä¾¿ç•¶", "è”¬èœä¾¿ç•¶"],
    éºµ: ["ç‰›è‚‰éºµ", "ä¹¾æ‹Œéºµ", "æ‹‰éºµ", "ç‚’éºµ"],
    é£¯: ["å’–å“©é£¯", "ç‚’é£¯", "ä¸¼é£¯", "æ»·è‚‰é£¯"],
    é€Ÿé£Ÿ: ["æ¼¢å ¡", "ç‚¸é›", "æŠ«è–©", "è–¯æ¢"]
  };

  const today = new Date().toISOString().slice(0, 10);
  let record = JSON.parse(localStorage.getItem("lunchRecord"));

  if (!record || record.date !== today) {
    record = { date: today, used: [] };
    localStorage.setItem("lunchRecord", JSON.stringify(record));
  }

  const chat = document.getElementById("chat");

  function addBubble(text, type) {
    const div = document.createElement("div");
    div.className = "bubble " + type;
    div.textContent = text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }

  function getSuggestion(category) {
    let options = [];

    if (category === "éš¨æ©Ÿ") {
      for (let key in LUNCH_OPTIONS) {
        options = options.concat(LUNCH_OPTIONS[key]);
      }
    } else {
      options = LUNCH_OPTIONS[category];
    }

    const available = options.filter(f => !record.used.includes(f));

    if (available.length === 0) {
      return "ä»Šå¤©çš„é¤é»éƒ½è¢«æ¨è–¦éäº† ğŸ˜…";
    }

    const choice = available[Math.floor(Math.random() * available.length)];
    record.used.push(choice);
    localStorage.setItem("lunchRecord", JSON.stringify(record));
    return "ä»Šå¤©åˆé¤å»ºè­°ä½ åƒï¼š" + choice;
  }

  function choose(category) {
    addBubble(category, "user");
    const reply = getSuggestion(category);
    setTimeout(() => addBubble(reply, "bot"), 300);
  }

  function resetToday() {
    record = { date: today, used: [] };
    localStorage.setItem("lunchRecord", JSON.stringify(record));
    addBubble("å·²é‡æ–°é–‹å§‹ä»Šå¤©ï¼Œå¯ä»¥å†å¹«ä½ æƒ³åˆé¤ ğŸ½ï¸", "bot");
  }

  addBubble("é»é¸ä¸‹é¢æŒ‰éˆ•ï¼Œæˆ‘å¹«ä½ æ±ºå®šä»Šå¤©åƒä»€éº¼", "bot");
</script>

</body>
</html>
